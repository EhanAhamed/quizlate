<!doctype html>
<html lang="en">
  <!--
    Quizfreely
    Copyright (c) Ehan Ahamed and contributors
    Licensed under the UPL-1.0 License
    https://quizfreely.com/LICENSE.txt
  -->

  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=10, user-scalable=1"
    />
    <title>Quizfreely</title>
    <link rel="icon" href="/favicon.ico" sizes="32x32">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <eta>~ data.themeCss </eta>
    <link rel="stylesheet" href="/assets/fonts/fonts.css" />
    <link
      rel="stylesheet"
      href="/assets/nerdfonts/webfont.css"
    />
  </head>

  <body>
    <eta>~ include("./partials/body-start", { theme: data.theme }) </eta>
    <eta>~ include("./partials/navbar", { page: "home", apiUrl: data.apiUrl }) </eta>
    <eta>~ include("./partials/noscript") </eta>
    <main>
      <div class="grid page">
        <div class="content">
          <!--
          Starting point ig
          -->
          <div id="mainDashboarddiv">
            <p id="dashboard-noaccount-alert" class="fg0 hide">
              You're not signed in, so your sets will be saved offline.
            </p>
            <div class="flex">
              <a href="/studyset/create" class="button">
                <i class="nf nf-oct-plus"></i>
                Create new
              </a>
            </div>
            <div class="grid list" id="studyset-list">
              <div class="box flex center-h center-v">
                <div>Tap "create new" to create a studyset</div>
              </div>
            </div>
            <div id="mainDashboardImportother" class="modal hide">
              <div class="content">
                <h2>Import from another app</h2>
                <p>Delimiter/Seperator between term and definition</p>
                <input
                  type="text"
                  placeholder="Term delimiter"
                  id="mainDashboardImportotherTermdelimiter"
                />
                <p>
                  Delimiter/Seperator between rows, leave blank to use a
                  newline/enter
                </p>
                <input
                  type="text"
                  placeholder="Row delimiter"
                  id="mainDashboardImportotherRowdelimiter"
                />
                <textarea
                  id="mainDashboardImportotherData"
                  class="fullWidth"
                  rows="10"
                  placeholder="Paste data here"
                ></textarea>
                <div class="flex">
                  <button id="mainDashboardImportotherImportbutton">
                    Import
                  </button>
                  <button
                    class="red"
                    onclick="document.getElementById('mainDashboardImportother').classList.add('hide')"
                  >
                    Cancel
                  </button>
                </div>
              </div>
            </div>
            <div id="mainDashboardNewuserdiv" class="hide">
              <p>
                You are not signed in. You can continue using Quizfreely without
                an account, <br />
                or you can <a href="./start.html">get started</a> to save study
                sets to an account instead of manually saving them.
              </p>
            </div>
            <div id="mainDashboardUserdiv" class="hide">
              <p>
                You are signed in. Study sets saved to your account are shown
                below.
              </p>
              <div
                id="mainDashboardUserStudysetlistdiv"
                class="grid list"
              ></div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <eta>~ include("./partials/footer") </eta>
    <script src="/assets/js/client.js"></script>
    <script src="/assets/js/dayjs.min.js"></script>
    <script src="/assets/js/calendar.js"></script>
    <script>
      client.apiUrl = "<eta>= data.apiUrl </eta>"
      dayjs.extend(window.dayjs_plugin_calendar);
      var dayjsCalendarOptions = {
        sameDay: "[Today at] h:mm A", // Today at 11:22 PM
        nextDay: "[Tomorrow at] h:mm A", // Tomorrow at 11:22 PM
        nextWeek: "ddd, MMM D [at] h:mm A", // Fri, Aug 30 at 11:22 PM
        lastDay: "[Yesterday at] h:mm A", // Yesterday at 11:22 PM
        lastWeek: "ddd, MMM D [at] h:mm A", // Fri, Aug 30 at 11:22 PM
        sameElse: "ddd, MMM D (YYYY-MM-DD)", // Fri, Aug 30 (2024-08-30)
      };
      if (window.localStorage && (localStorage.getItem("settingTimeHour") == "24h")) {
        dayjsCalendarOptions = {
          sameDay: "[Today at] H:mm", // Today at 23:22
          nextDay: "[Tomorrow at] H:mm", // Tomorrow at 23:22
          nextWeek: "ddd, MMM D [at] H:mm", // Fri, Aug 30 at 23:22
          lastDay: "[Yesterday at] H:mm", // Yesterday at 23:22
          lastWeek: "ddd, MMM D [at] H:mm", // Fri, Aug 30 at 23:22
          sameElse: "ddd, MMM D (YYYY-MM-DD)", // Fri, Aug 30 (2024-08-30)
        }
      }
      if (client.hasSession()) {
        document.getElementById("dashboard-noaccount-alert").classList.add("hide");
        client.req({ method: "GET", path: "/list/my-studysets" }, function (result) {
          if (result.data && result.data.rows.length >= 1) {
            document.getElementById("studyset-list").innerHTML = "";
            for (var i = 0; i < result.data.rows.length; i++) {
              var box = document.createElement("div");
              box.classList.add("box");
              var title = document.createElement("a");
              title.innerText = result.data.rows[i].title;
              if (result.data.rows[i].private) {
                title.href = "/studyset/private/" + result.data.rows[i].id
              } else {
                title.href = "/studysets/" + result.data.rows[i].id
              }
              var time = document.createElement("p");
              time.innerText = dayjs(result.data.rows[i].updated_at).calendar(
                null,
                dayjsCalendarOptions
              )
              time.classList.add("h6")
              box.appendChild(title);
              box.appendChild(time);
              document.getElementById("studyset-list").appendChild(box);
            }
          }
        })
      } else {
        document.getElementById("dashboard-noaccount-alert").classList.remove("hide");
      }
    </script>
  </body>
</html>
